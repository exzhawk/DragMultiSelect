// Generated by CoffeeScript 1.10.0
(function() {
  (function($, window) {
    return $.fn.DragMultiSelect = function() {
      var $this, items, items_status, lastIndex, movedFlag, selectedFlag, selectingFlag, startIndex, toggleAll, triggerCount;
      selectingFlag = false;
      selectedFlag = false;
      startIndex = -1;
      lastIndex = -1;
      movedFlag = false;
      items_status = [];
      $this = $(this);
      items = $this.children();
      triggerCount = function() {
        var count, item;
        count = ((function() {
          var i, len, results;
          results = [];
          for (i = 0, len = items.length; i < len; i++) {
            item = items[i];
            if ($(item).hasClass("DragMultiSelect-selected")) {
              results.push(item);
            }
          }
          return results;
        })()).length;
        return $this.trigger("DragMultiSelectEvent", [count]);
      };
      items.on("mousedown touchstart", function(event) {
        var item;
        event.preventDefault();
        movedFlag = false;
        selectingFlag = true;
        $this = $(this);
        selectedFlag = !$this.hasClass("DragMultiSelect-selected");
        startIndex = items.index($this);
        return items_status = (function() {
          var i, len, results;
          results = [];
          for (i = 0, len = items.length; i < len; i++) {
            item = items[i];
            results.push($(item).hasClass("DragMultiSelect-selected"));
          }
          return results;
        })();
      }).on("mouseup touchend", function(event) {
        selectingFlag = false;
        if (!movedFlag && items.index($(this)) === startIndex) {
          $(this).toggleClass("DragMultiSelect-selected");
        }
        movedFlag = false;
        return triggerCount();
      }).on("mousemove touchmove", function(event) {
        var endIndex, i, index, ref;
        movedFlag = true;
        if (selectingFlag) {
          endIndex = items.index($(this));
          for (index = i = 0, ref = items.length; 0 <= ref ? i < ref : i > ref; index = 0 <= ref ? ++i : --i) {
            if (((startIndex <= index && index <= endIndex)) || ((endIndex <= index && index <= startIndex))) {
              $(items[index]).toggleClass("DragMultiSelect-selected", selectedFlag);
            } else {
              $(items[index]).toggleClass("DragMultiSelect-selected", items_status[index]);
            }
          }
        }
        if (lastIndex !== endIndex) {
          triggerCount();
          return lastIndex = endIndex;
        }
      });
      toggleAll = function(toOption) {
        var i, item, len;
        for (i = 0, len = items.length; i < len; i++) {
          item = items[i];
          $(item).toggleClass("DragMultiSelect-selected", toOption);
        }
        return triggerCount();
      };
      this.SelectAll = function() {
        return toggleAll(true);
      };
      this.DeselectAll = function() {
        return toggleAll(false);
      };
      this.SelectReserve = function() {
        return toggleAll(void 0);
      };
      return this;
    };
  })(window.jQuery, window);

}).call(this);

//# sourceMappingURL=DragMultiSelect.js.map
